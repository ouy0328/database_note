# 数据模型

## 06. 层次数据模型

### 基本概念

![](https://cdn.jsdelivr.net/gh/ouy0328/note_picture/img/20221220151915.png)

由于显示世界中的许多事物之间存在层次关系，层析数据模型用树来描述这些关系。

- 记录 (record)：把显示世界的一个实体表达为一个记录
- 域 (field)：一个记录由若干个域来描述
- 双亲子女关系 (PCR)：层次数据模型中最基本的数据关系。它表示两个数据类型间一对多的关系。

### 层次数据模式

![](https://cdn.jsdelivr.net/gh/ouy0328/note_picture/img/20221220154346.png)

- 一个层次数据模式包含多个PCR
- 每一个PCR表示一个一对多的关系
- 每一个记录类型只能有一个父节点

### 虚记录

![](https://cdn.jsdelivr.net/gh/ouy0328/note_picture/img/20221220160454.png)

在现实世界，许多数据不是层次型，它们很难直接用PCR表示出来。

- 不同记录间多对多的关系
- 一个记录类型可能有多个父节点
- 多元关系

![](https://cdn.jsdelivr.net/gh/ouy0328/note_picture/img/20221220162120.png)

为避免冗余，引入虚拟记录来表达上述关系。它实际上是指针，由虚记录指向真实记录。

## 07. 网状数据模型

### 基本概念

![](https://cdn.jsdelivr.net/gh/ouy0328/note_picture/img/20230103155253.png)

- 网状数据模型的基本数据结构为系 (set)，表达显示世界中两个数据类型一对多的关系。其中一为主记录，多为属记录。在网状数据模型中，一个记录类型可以为多个系的主记录，也可以是多个系的属记录。
- 突破了层次数据结构的限制，比层次模型更加容易地表达显示世界。
- 网状数据模型

### 举例

![](https://cdn.jsdelivr.net/gh/ouy0328/note_picture/img/20230103160002.png)

主记录：Class

属记录：Student

## 08. 关系数据模型
### 基本概念

![](https://cdn.jsdelivr.net/gh/ouy0328/database_note/img/20230207152031.png)
- 在关系模型中，基本的数据结构只有一种“表(table)”，或叫做关系(relation)。现实世界中的实体和实体之间的关系全部用表来表示，所以它所以可以用严格的数学方法研究。
  - 基于数学中的集合论，拥有更高的抽象级别。
  
  - 屏蔽了所有底层的实现，包括编程细节。整个数据模型的概念非常简单、清楚、容易理解。
  
  - 可以建立新的代数系统——关系代数
  
  - 非过程化的查询语言，不需要程序员自己编写程序——SQL
  
  - 软连接——可以看成一种逻辑指针。
  
    举例：
  
    ![](https://cdn.jsdelivr.net/gh/ouy0328/database_note/img/20230207154443.png)

### 基本术语和概念

#### 属性和域

![](https://cdn.jsdelivr.net/gh/ouy0328/database_note/img/20230207155854.png)
- 现实世界中实体的特征表示为属性
  - 一个学生可以被如下属性描述：姓名、学号、性别、年龄、生日、国籍等。
- 一个属性的取值范围被称为它的域。
  - 原子数据（基本数据类型，不可再分）——第一范式
  - 允许属性的值为空值（空值为未知，不是0也不是空串）
#### 关系和元组
![](https://cdn.jsdelivr.net/gh/ouy0328/database_note/img/20230207162647.png)
- 现实世界的实体以及实体之间的联系可以用一个或多个关系来表达。关系实际上就是在它属性的值域上定义的一个N元联系。 简称为表。
- 表内的每一行为一个元组。

#### 主键

![](https://cdn.jsdelivr.net/gh/ouy0328/database_note/img/20230208142711.png)

##### 候选键定义

满足以下条件的属性被称为候选键：

- 关系内任意两条不同元组的这个值都不一样，或者说这组属性的值能够唯一确定其他属性的值。
- 这组属性的任意一个子集没有这个特性。

满足第一个条件但不满足第二个条件则被称为超键。

##### 主键定义

候选键可能有多个，可以指定其中一个为主键，其他为候补键。

主键可能是由关系内所有属性组成，这种主键称为全键。

#### 外键

![](https://cdn.jsdelivr.net/gh/ouy0328/database_note/img/20230208152104.png)

##### 定义

在一个关系内，由一组属性用来引用另一张表内的元组，那么这一组属性就被称为外键。外键应该是被引用的表的主键。

##### 引用完整性

如果把外键堪称一个逻辑指针，那么该逻辑指针不能当空（不能指向空值）。

##### 举例

![](https://cdn.jsdelivr.net/gh/ouy0328/database_note/img/20230208160052.png)

选课表通过sid引用学生表中的内容。

#### 完整性约束

- 通过外键的引用完整性约束
- 域完整性约束：一张表中每条元组的每一个属性的值都必须符合它的值域的要求。
- 实体完整性约束：关系内主键的值不能为空，主键为空则不能唯一标识一个元组。

##### 举例

![](https://cdn.jsdelivr.net/gh/ouy0328/database_note/img/20230208160606.png)

- S1和S2为水手信息表，sid 水手编号 sname 水手姓名 rateing 水手级别 age 水手年龄，主键为sid
- B1为船只信息表，bid 船只编号 bname 船只名字 color 船只颜色，主键为bid
- R1为水手和船只之间的预定关系表，sid 水手编号 bid 船只编号 day 预定日期，主键为全键

## 09. 关系代数基本操作

关系代数是关系模型的理论基础

### 五个基本操作

![](https://cdn.jsdelivr.net/gh/ouy0328/database_note/img/20230208163147.png)

- selection(σ)：选择操作，从一个表中筛选出符合条件的元组。
- projection(π)：投影操作，删除表中不需要的列
- cross-product(×)：笛卡尔乘积，将两个关系拼接在一起，拼成一个大的关系
- set-difference(－)：集合差操作，找出属于关系①但不属于关系②的元组
- union(∪)：集合并操作，把两个模式相同的元组合并起来

#### 其他操作

不是必须的，但非常有用

- intersection 集合交集
- join 两个表连接操作
- division 除法操作
- outer join 外连接
- outer union 外并

#### 投影操作

![](https://cdn.jsdelivr.net/gh/ouy0328/database_note/img/20230208172547.png)

## 10. 关系代数连接操作

## 11. 关系代数除法和外连接操作

## 12. 关系演算

## 13. 传统数据模型评价

## 14. ER数据模型和面向对象数据模型